/**
 * 主题工具函数和 Mixin
 * 提供可重用的主题相关样式工具
 */

@use './variables.scss' as *;

// ========== 主题感知的颜色函数 ==========

// 获取主题感知的颜色
@function theme-color($color, $variant: 'base') {
  @if $color == 'primary' {
    @if $variant == 'hover' {
      @return var(--primary-hover);
    } @else if $variant == 'pressed' {
      @return var(--primary-pressed);
    } @else if $variant == 'light' {
      @return var(--primary-light);
    } @else if $variant == 'lighter' {
      @return var(--primary-lighter);
    } @else {
      @return var(--primary);
    }
  } @else if $color == 'secondary' {
    @if $variant == 'hover' {
      @return var(--secondary-hover);
    } @else if $variant == 'pressed' {
      @return var(--secondary-pressed);
    } @else if $variant == 'light' {
      @return var(--secondary-light);
    } @else if $variant == 'lighter' {
      @return var(--secondary-lighter);
    } @else {
      @return var(--secondary);
    }
  } @else if $color == 'accent' {
    @if $variant == 'hover' {
      @return var(--accent-blue-hover);
    } @else if $variant == 'pressed' {
      @return var(--accent-blue-pressed);
    } @else if $variant == 'light' {
      @return var(--accent-blue-light);
    } @else {
      @return var(--accent-blue);
    }
  } @else if $color == 'surface' {
    @if $variant == '1' {
      @return var(--surface-1);
    } @else if $variant == '2' {
      @return var(--surface-2);
    } @else if $variant == '3' {
      @return var(--surface-3);
    } @else if $variant == 'hover' {
      @return var(--surface-hover);
    } @else if $variant == 'pressed' {
      @return var(--surface-pressed);
    } @else {
      @return var(--surface-1);
    }
  }
  @return var(--primary);
}

// 获取主题感知的文本颜色
@function theme-text($level: 'primary') {
  @if $level == 'primary' {
    @return var(--text-primary);
  } @else if $level == 'secondary' {
    @return var(--text-secondary);
  } @else if $level == 'tertiary' {
    @return var(--text-tertiary);
  } @else if $level == 'quaternary' {
    @return var(--text-quaternary);
  } @else if $level == 'disabled' {
    @return var(--text-disabled);
  } @else if $level == 'accent' {
    @return var(--text-accent);
  } @else if $level == 'inverse' {
    @return var(--text-inverse);
  }
  @return var(--text-primary);
}

// ========== 高级主题 Mixin ==========

// 主题感知的按钮样式
@mixin theme-button($variant: 'primary', $size: 'medium') {
  border: none;
  border-radius: var(--radius-md);
  font-weight: var(--font-weight-semibold);
  cursor: pointer;
  transition: all var(--transition-base);
  
  @if $size == 'small' {
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: var(--font-size-sm);
  } @else if $size == 'large' {
    padding: var(--spacing-md) var(--spacing-xl);
    font-size: var(--font-size-lg);
  } @else {
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: var(--font-size-base);
  }
  
  @if $variant == 'primary' {
    @include gradient-bg('primary');
    color: white;
    @include glow-effect('primary', 'soft');
    
    &:hover {
      @include glow-effect('primary', 'medium');
      transform: translateY(-1px);
    }
    
    &:active {
      transform: translateY(0);
    }
  } @else if $variant == 'secondary' {
    background: theme-color('surface', '2');
    color: theme-text('primary');
    border: 1px solid var(--border-primary);
    
    &:hover {
      background: theme-color('surface', '3');
      border-color: theme-color('primary');
    }
  } @else if $variant == 'ghost' {
    background: transparent;
    color: theme-text('secondary');
    
    &:hover {
      background: theme-color('surface', '1');
      color: theme-text('primary');
    }
  }
}

// 主题感知的卡片样式
@mixin theme-card($variant: 'default', $padding: 'medium') {
  @include theme-glass();
  border-radius: var(--radius-lg);
  
  @if $padding == 'small' {
    padding: var(--spacing-md);
  } @else if $padding == 'large' {
    padding: var(--spacing-xl);
  } @else {
    padding: var(--spacing-lg);
  }
  
  @if $variant == 'elevated' {
    box-shadow: var(--shadow-medium);
  } @else if $variant == 'outlined' {
    border: 1px solid var(--border-primary);
  } @else if $variant == 'filled' {
    background: theme-color('surface', '2');
  }
}

// 主题感知的输入框样式
@mixin theme-input($variant: 'default') {
  background: theme-color('surface', '1');
  border: 1px solid var(--border-secondary);
  border-radius: var(--radius-md);
  padding: var(--spacing-sm) var(--spacing-md);
  color: theme-text('primary');
  font-size: var(--font-size-base);
  transition: all var(--transition-base);
  
  &::placeholder {
    color: theme-text('tertiary');
  }
  
  &:focus {
    outline: none;
    border-color: theme-color('primary');
    @include glow-effect('primary', 'soft');
  }
  
  &:disabled {
    background: theme-color('surface', '1');
    color: theme-text('disabled');
    cursor: not-allowed;
  }
  
  @if $variant == 'filled' {
    background: theme-color('surface', '2');
    border: none;
  } @else if $variant == 'outlined' {
    background: transparent;
    border: 2px solid var(--border-primary);
  }
}

// 主题感知的导航样式
@mixin theme-navigation($variant: 'glass') {
  @if $variant == 'glass' {
    @include theme-glass(0.05, 10px);
    backdrop-filter: var(--glass-blur);
  } @else if $variant == 'solid' {
    background: var(--base-dark);
    border-bottom: 1px solid var(--border-primary);
  } @else if $variant == 'floating' {
    @include theme-glass();
    border-radius: var(--radius-xl);
    margin: var(--spacing-md);
    @include glow-effect('primary', 'soft');
  }
}

// 主题感知的模态框样式
@mixin theme-modal($backdrop: true) {
  background: var(--base-dark);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-strong);
  border: 1px solid var(--border-primary);
  
  @if $backdrop {
    &::backdrop {
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
    }
  }
}

// 主题感知的滚动条样式
@mixin theme-scrollbar($size: 'medium') {
  $width: 8px;
  @if $size == 'small' {
    $width: 4px;
  } @else if $size == 'large' {
    $width: 12px;
  }
  
  &::-webkit-scrollbar {
    width: $width;
    height: $width;
  }
  
  &::-webkit-scrollbar-track {
    background: theme-color('surface', '1');
    border-radius: var(--radius-full);
  }
  
  &::-webkit-scrollbar-thumb {
    background: theme-color('surface', '3');
    border-radius: var(--radius-full);
    
    &:hover {
      background: theme-color('surface', 'hover');
    }
  }
  
  // Firefox
  scrollbar-width: thin;
  scrollbar-color: theme-color('surface', '3') theme-color('surface', '1');
}

// 主题感知的加载动画
@mixin theme-loading-spinner($size: 'medium', $color: 'primary') {
  $spinner-size: 24px;
  @if $size == 'small' {
    $spinner-size: 16px;
  } @else if $size == 'large' {
    $spinner-size: 32px;
  }
  
  width: $spinner-size;
  height: $spinner-size;
  border: 2px solid theme-color('surface', '2');
  border-top: 2px solid theme-color($color);
  border-radius: var(--radius-full);
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

// 主题感知的工具提示
@mixin theme-tooltip($position: 'top') {
  background: var(--base-dark);
  color: theme-text('primary');
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-sm);
  box-shadow: var(--shadow-medium);
  border: 1px solid var(--border-primary);
  
  // 箭头样式可以根据需要添加
}
